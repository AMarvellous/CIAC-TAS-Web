
@{
    ViewBag.Title = "ASACuestionarioGrafica";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            Preguntas ASA
            <small> Grafica Cuestionario</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
            <li><a href="#">Grafica</a></li>
            <li class="active">Preguntas ASA</li>
        </ol>
    </section>
    <!-- Main content -->
    <section class="content">
        <!-- Default box -->
        <div class="box">
            @*<div class="box-header with-border">
                    <h3 class="box-title">CIAC TAS</h3>
                    <div class="box-tools pull-right">
                        <button type="button" class="btn btn-box-tool" data-widget="collapse" data-toggle="tooltip"
                                title="Collapse">
                            <i class="fa fa-minus"></i>
                        </button>
                        <button type="button" class="btn btn-box-tool" data-widget="remove" data-toggle="tooltip" title="Remove">
                            <i class="fa fa-times"></i>
                        </button>
                    </div>
                </div>*@
            <div class="box-body">
                <!-- DONUT CHART -->
                <div class="box box-danger">
                    <div class="box-header with-border">
                        <h3 class="box-title">Grafica Donut</h3>
                        <div class="box-tools pull-right">
                            <button type="button" class="btn btn-box-tool" data-widget="collapse">
                                <i class="fa fa-minus"></i>
                            </button>
                            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
                        </div>
                    </div>
                    @{
                        //List<adminlte.ASATransaccionService.ASATransaccionEntity> ltASATransaccion = ViewBag.ltASATransaccion;
                        List<IGrouping<long, adminlte.ASATransaccionService.ASATransaccionEntity>> grpltASATransaccion = ViewBag.ltASATransaccion;
                        if (grpltASATransaccion != null)
                        {

                            int i = 0;
                            //List<IGrouping<long,adminlte.ASATransaccionService.ASATransaccionEntity>> grpltASATransaccion = ltASATransaccion.GroupBy(g => g.Intento).ToList();
                            foreach (var Transaccion in grpltASATransaccion)
                            {
                                <div class="box-body chart-responsive">
                                    <div class="chart" id="sales-chart @i" style="height: 300px; position: relative;"></div>
                                </div>
                                @*<div>
                                    @Transaccion.First().FechaDoc.ToString()
                                </div>*@
                                <div class="col-md-6 col-md-offset-3">
                                    
                                        
                                        <!-- /.box-header -->
                                        <div class="box-body">
                                            
                                            <div class="alert alert-success alert-dismissible">
                                                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                                                <h4><i class="icon fa fa-check"></i> Fecha</h4>
                                                @Transaccion.First().FechaDoc.ToString()
                                            </div>
                                        </div>
                                        <!-- /.box-body -->
                                    
                                    <!-- /.box -->
                                </div>
                                i++;
                            }
                        }
                    }



                    @*<div class="box-body chart-responsive">
            <div class="chart" id="sales-chart" style="height: 300px; position: relative;"></div>
        </div>
        <div class="box-body chart-responsive">
            <div class="chart" id="sales-chart2" style="height: 300px; position: relative;"></div>
        </div>*@
                    <!-- /.box-body -->
                </div>


            </div>
            <!-- /.box-body -->
            <div class="box-footer">
                Grafica
            </div>
            <!-- /.box-footer-->
        </div>
        <!-- /.box -->
    </section>
    <!-- /.content -->
</div>
<!-- /.content-wrapper -->


@section Scripts
{

    <script>
        $(document).ready(function () {
            "use strict";

            var ltASATransaccionJquery = @Html.Raw(Json.Encode(ViewBag.ltASATransaccion));
            
            $.each(ltASATransaccionJquery, function (index, item) {
                // access the properties of each user
                var sumaCorrectos = 0;
                var sumaInCorrectos = 0;
                var sumaNoRespondidos = 0;
                
                $.each(item, function (i, Transaccion) {
                    if (Transaccion.Opcion == 0) {
                        sumaNoRespondidos = sumaNoRespondidos + 1;
                    } else
                    {
                         if(Transaccion.Correcto == false) {
                             sumaInCorrectos = sumaInCorrectos + 1;
                         } else if (Transaccion.Correcto == true){
                             sumaCorrectos = sumaCorrectos = + 1;
                        } 
                    }
                });

                var donut = new Morris.Donut({
                element: 'sales-chart ' + index,
                resize: true,
                    colors: ["#00a65a", "#f56954","#000000"],
                data: [
                    { label: "Correcto", value: sumaCorrectos },
                    { label: "Incorrecto", value: sumaInCorrectos },
                    { label: "No respondido", value: sumaNoRespondidos },
                ],
                hideHover: 'auto'
            });

                //console.log(sumaCorrectos)
                //console.log(sumaInCorrectos)
                //console.log(sumaNoRespondidos)
                //console.log("**********")

            });

            //var donut = new Morris.Donut({
            //    element: 'sales-chart ' + index,
            //    resize: true,
            //    colors: ["#3c8dbc", "#f56954"],
            //    data: [
            //        { label: "Correcto", value: 12 },
            //        { label: "Incorrecto", value: 30 }
            //    ],
            //    hideHover: 'auto'
            //});

            ////DONUT CHART
            //var donut = new Morris.Donut({
            //    element: 'sales-chart',
            //    resize: true,
            //    colors: ["#3c8dbc", "#f56954"],
            //    data: [
            //        { label: "Download Sales", value: 12 },
            //        { label: "In-Store Sales", value: 30 }
            //    ],
            //    hideHover: 'auto'
            //});
            //var donut = new Morris.Donut({
            //    element: 'sales-chart2',
            //    resize: true,
            //    colors: ["#3c8dbc", "#f56954"],
            //    data: [
            //        { label: "Download Sales", value: 12 },
            //        { label: "In-Store Sales", value: 30 }
            //    ],
            //    hideHover: 'auto'
            //});

        });
    </script>

}