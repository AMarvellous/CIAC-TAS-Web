@model adminlte.TASRegistroNotasService.TASRegistroNotasSet

@{
    ViewBag.Title = "TASRegistroNotasNuevo";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
        <h1>
            TAS
            <small>Registro Notas</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
            <li><a href="#">Registro Notas</a></li>
            <li class="active">Configuracion</li>
        </ol>
    </section>
    <!-- Main content -->
    <section class="content">
        <!-- Default box -->
        <div class="box box-primary">
            @using (Html.BeginForm())
            {
                <div class="box-header with-border">
                    <h3 class="box-title">CIAC TAS</h3>
                </div>
                <!-- /.box-header -->

                <!-- form start -->
                @*<form role="form">*@
                <div class="box-body">

                    @Html.AntiForgeryToken()

                    <div class="form-group">
                        @Html.Label("Programa")
                        <div class="input-group">
                            <div class="input-group-addon">
                                <i class="fa fa-users"></i>
                            </div>
                            @*@Html.EditorFor(model => model.ltTASRegistroNotas[0].Grupo, new { htmlAttributes = new { @class = "form-control" } })*@
                            @Html.DropDownListFor(model => model.ltTASRegistroNotas[0].Programa, new SelectList(@ViewBag.ltTASPrograma as System.Collections.IEnumerable, null, "Programa"), "Programa", new { @class = "form-control controlar" })
                            @Html.ValidationMessageFor(model => model.ltTASRegistroNotas[0].Programa, "", new { @class = "text-danger" })
                            @*<input type="number" class="form-control">*@
                        </div>
                        <!-- /.input group -->
                    </div>

                    <div class="form-group">
                        @Html.Label("Grupo")
                        <div class="input-group">
                            <div class="input-group-addon">
                                <i class="fa fa-users"></i>
                            </div>
                            @*@Html.EditorFor(model => model.ltTASRegistroNotas[0].Grupo, new { htmlAttributes = new { @class = "form-control" } })*@
                            @Html.DropDownListFor(model => model.ltTASRegistroNotas[0].Grupo, new SelectList(@ViewBag.ltTASGrupo as System.Collections.IEnumerable, null, "Grupo"), "Grupo", new { @class = "form-control controlar" })
                            @Html.ValidationMessageFor(model => model.ltTASRegistroNotas[0].Grupo, "", new { @class = "text-danger" })
                            @*<input type="number" class="form-control">*@
                        </div>
                        <!-- /.input group -->
                    </div>


                    <div class="form-group">
                        @Html.Label("Materia")
                        <div class="input-group">
                            <div class="input-group-addon">
                                <i class="fa fa-users"></i>
                            </div>
                            @*@Html.EditorFor(model => model.ltTASRegistroNotas[0].Grupo, new { htmlAttributes = new { @class = "form-control" } })*@
                            @Html.DropDownListFor(model => model.ltTASRegistroNotas[0].Materia, new SelectList(@ViewBag.ltTASMateria as System.Collections.IEnumerable, null, "Materia"), "Materia", new { @class = "form-control controlar" })
                            @Html.ValidationMessageFor(model => model.ltTASRegistroNotas[0].Materia, "", new { @class = "text-danger" })
                            @*<input type="number" class="form-control">*@
                        </div>
                        <!-- /.input group -->
                    </div>
                    <div class="form-group">
                        @Html.Label("Modulo")
                        <div class="input-group">
                            <div class="input-group-addon">
                                <i class="fa fa-users"></i>
                            </div>
                            @*@Html.EditorFor(model => model.ltTASRegistroNotas[0].Grupo, new { htmlAttributes = new { @class = "form-control" } })*@
                            @Html.DropDownListFor(model => model.ltTASRegistroNotas[0].ModuloMateria, new SelectList(@ViewBag.ltTASModulo as System.Collections.IEnumerable, null, "Modulo"), "Modulo", new { @class = "form-control controlar" })
                            @Html.ValidationMessageFor(model => model.ltTASRegistroNotas[0].ModuloMateria, "", new { @class = "text-danger" })
                            @*<input type="number" class="form-control">*@
                        </div>
                        <!-- /.input group -->
                    </div>
                    <div class="form-group">
                        @Html.Label("Gestion")
                        <div class="input-group">
                            <div class="input-group-addon">
                                <i class="fa fa-users"></i>
                            </div>
                            @*@Html.EditorFor(model => model.ltTASRegistroNotas[0].Grupo, new { htmlAttributes = new { @class = "form-control" } })*@
                            @Html.DropDownListFor(model => model.ltTASRegistroNotas[0].Gestion, new SelectList(@ViewBag.ltTASGestion as System.Collections.IEnumerable, null, "Gestion"), "Gestion", new { @class = "form-control controlar" })
                            @Html.ValidationMessageFor(model => model.ltTASRegistroNotas[0].Gestion, "", new { @class = "text-danger" })
                            @*<input type="number" class="form-control">*@
                        </div>
                        <!-- /.input group -->
                    </div>

                    <div class="form-group">
                        @Html.Label("Progregos Cantidad")
                        <div class="input-group">
                            <div class="input-group-addon">
                                <i class="fa fa-users"></i>
                            </div>
                            @*@Html.EditorFor(model => model.ltTASRegistroNotas[0].Grupo, new { htmlAttributes = new { @class = "form-control" } })*@
                            @Html.DropDownList("CantidadProgresos", new SelectList(@ViewBag.ltCantidadProgresos as System.Collections.IEnumerable), "Cantidad de Progresos", new { @class = "form-control controlar" })
                            @*<input type="number" class="form-control">*@
                        </div>
                        <!-- /.input group -->
                    </div>

                    @Html.HiddenFor(model => model.ltTASRegistroNotas[0].NumeroProgresos)
                    @Html.HiddenFor(model => model.ltTASRegistroNotas[0].NombreReferenciaProgreso)
                    @Html.HiddenFor(model => model.ltTASRegistroNotas[0].PorcentajeIndividualProgreso)

                </div>
                <!-- /.box-body -->

                <div class="box-footer">
                    <button type="submit" class="btn btn-primary">Siguiente</button>
                </div>
                @*</form>*@
            }
        </div>
        <!-- /.box -->
    </section>
    <!-- /.content -->
</div>
<!-- /.content-wrapper -->
@*@Scripts.Render("~/bundles/jquery")*@
@section scripts{

    <script type="text/javascript">

        $(document).on('change', '#CantidadProgresos', function (e) {
            $('#Container').html('');
            $("div.divCreated").remove();
            if ($('#CantidadProgresos').val() > 0) {

                for (i = 0; i < $('#CantidadProgresos').val(); i++) {
                    //Agregar los progresos aca
                    var Row = '<div class="row divCreated">';
                    Row += '<div class="col-xs-5">'
                    Row += '<input type="text" class="form-control nombreEvaluacion" placeholder="Nombre Progreso">'
                    Row += '</div>'
                    Row += '<div class="col-xs-5">'
                    Row += '<input type="text" class="form-control allownumericwithdecimal porcentajeEvaluacion" placeholder="Porcentaje Progreso">'
                    Row += '</div>'
                    Row += '</div>'

                    $(".box-body").append(Row);

                }
                $(".allownumericwithdecimal").on("keypress keyup blur", function (event) {
                    //this.value = this.value.replace(/[^0-9\.]/g,'');
                    $(this).val($(this).val().replace(/[^0-9\.]/g, ''));
                    if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57)) {
                        event.preventDefault();
                    }
                });
            }
            else {

            }

        })

        $('form').submit(function () {

            if ($('#ltTASRegistroNotas_0__Programa').val() == '') {
                alert("No se selecciono ningun Programa");
                return false;
            }

            if ($('#ltTASRegistroNotas_0__Grupo').val() == '') {
                alert("No se selecciono ningun Grupo");
                return false;
            }

            if ($('#ltTASRegistroNotas_0__Materia').val() == '') {
                alert("No se selecciono ninguna Materia");
                return false;
            }

            if ($('#ltTASRegistroNotas_0__ModuloMateria').val() == '') {
                alert("No se selecciono ningun Modulo");
                return false;
            }

            if ($('#ltTASRegistroNotas_0__Gestion').val() == '') {
                alert("No se selecciono ninguna Gestion");
                return false;
            }

            if ($('#CantidadProgresos').val() == '') {
                alert("No se selecciono ninguna cantidad de evaluacion de progreso");
                return false;
            }
            $("#ltTASRegistroNotas_0__NumeroProgresos").val($('#CantidadProgresos').val());

            var strConcat = '';
            $("input.nombreEvaluacion").each(function () {

                strConcat += "*.-Split-.*" + $(this).val();
                //alert($(this).val())
            });
            $("#ltTASRegistroNotas_0__NombreReferenciaProgreso").val(strConcat);

            var SumPorcentaje = 0;
            var strPorcentaje = '';
            $("input.porcentajeEvaluacion").each(function () {
                strPorcentaje += "*.-Split-.*" + Number($(this).val());
                SumPorcentaje += Number($(this).val());
            });

            if (SumPorcentaje == 30) {
                $("#ltTASRegistroNotas_0__PorcentajeIndividualProgreso").val(strPorcentaje);
            } else {
                alert('La suma de porcentajes no es 30, la suma actual es:' + SumPorcentaje);
                return false;
            }

            //// Check if empty of not
            //if (name === '') {
            //    alert('Text-field is empty.');
            //    return false;
            //}
        });

        //$(document).on('click', 'form button[type=submit]', function (e) {
        //        var isValid = $(e.target).parents('form').isValid();
        //        if (!isValid) {
        //            e.preventDefault(); //prevent the default action
        //        }
        //    });

        //$(".allownumericwithdecimal").on("keypress keyup blur", function (event) {
        //    alert("as")
        //    //this.value = this.value.replace(/[^0-9\.]/g,'');
        //    $(this).val($(this).val().replace(/[^0-9\.]/g, ''));
        //    if ((event.which != 46 || $(this).val().indexOf('.') != -1) && (event.which < 48 || event.which > 57)) {
        //        event.preventDefault();
        //    }
        //});

    </script>

}